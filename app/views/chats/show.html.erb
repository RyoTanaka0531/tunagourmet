<div class="container">
    <h1>チャットページ</h1>
    <% if producer_signed_in? %>
        <h3><%= @buyer.company_name %>さんとのチャットルーム</h3>
        <div class="chat-field">
            <% @messages.each do |msg| %>
                <!-- メッセージがproducerによるものだったら -->
                <% if msg.is_producer %>
                    <!-- メッセージを右に寄せる -->
                    <div class="right-message">
                        <%= msg.content %>
                        <%= attachment_image_tag @producer, :profile_image, style: "width:30px; height:30px", class: "img-circle pull-left profile-thumb", fallback: "no_image.jpg" %><br>
                        <%= msg.created_at.strftime("%Y/%m/%d %H:%M") %>
                    </div>
                <!-- メッセージがbuyerによるものだったら -->
                <% else %>
                    <!-- メッセージを左に寄せる -->
                    <div class="left-message">
                        <%= msg.content %><br>
                        <%= attachment_image_tag @buyer, :profile_image, style: "width:30px; height:30px", class: "img-circle pull-left profile-thumb", fallback: "no_image.jpg" %>
                        <%= @buyer.company_name %>
                        <%= msg.created_at.strftime("%Y/%m/%d %H:%M") %>
                    </div>
                <% end %>
            <% end %>
        </div>
    <% elsif buyer_signed_in? %>
        <h3><%= @producer.company_name%>さんとのチャットルーム</h3>
        <div class="chat-field">
            <% @messages.each do |msg| %>
                <!-- メッセージがproducerによるものだったら -->
                <% if msg.is_producer %>
                    <!-- メッセージを左に寄せる -->
                    <div class="left_message">
                        <%= msg.content%><br>
                        <%= attachment_image_tag @producer, :profile_image, style: "width:30px; height:30px", class: "img-circle pull-left profile-thumb", fallback: "no_image.jpg" %>
                        <%= @producer.company_name %><br>
                        <%= l msg.created_at %>
                    </div>
                <!-- メッセージがbuyerによるものだったら -->
                <% else %>
                    <!-- メッセージを右に寄せる -->
                    <div class="right-message">
                        <%= msg.content %>
                        <%= attachment_image_tag @buyer, :profile_image, style: "width:30px; height:30px", class: "img-circle pull-left profile-thumb", fallback: "no_image.jpg" %><br>
                        <%= l msg.created_at %>
                    </div>
                <% end %>
            <% end %>
        </div>
    <% end %>

    <%= form_for [@chat, @message] do |f| %>
        <%= f.text_field :content %>
        <%= f.submit "送信" %>
    <% end %>
</div>